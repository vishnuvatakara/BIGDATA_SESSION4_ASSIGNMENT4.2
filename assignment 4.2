grunt> A = load '/vishnu/television.txt' using PigStorage ('|') as (cmp:chararray,mod:chararray,size:int,state:chararray,pin:long,price:long);

(Samsung,Optima,14,Madhya Pradesh,132401,14200)
(Onida,Lucid,18,Uttar Pradesh,232401,16200)
(Akai,Decent,16,Kerala,922401,12200)
(Lava,Attention,20,Assam,454601,24200)
(Zen,Super,14,Maharashtra,619082,9200)
(Samsung,Optima,14,Madhya Pradesh,132401,14200)
(Onida,Lucid,18,Uttar Pradesh,232401,16200)
(Onida,Decent,14,Uttar Pradesh,232401,16200)
(Onida,NA,16,Kerala,922401,12200)
(Lava,Attention,20,Assam,454601,24200)
(Zen,Super,14,Maharashtra,619082,9200)
(Samsung,Optima,14,Madhya Pradesh,132401,14200)
(NA,Lucid,18,Uttar Pradesh,232401,16200)
(Samsung,Decent,16,Kerala,922401,12200)
(Lava,Attention,20,Assam,454601,24200)
(Samsung,Super,14,Maharashtra,619082,9200)
(Samsung,Super,14,Maharashtra,619082,9200)
(Samsung,Super,14,Maharashtra,619082,9200)
=====================
grunt> describe A;
A: {cmp: chararray,mod: chararray,size: int,state: chararray,pin: long,price: long}
grunt> 
==============================
grunt> B = foreach A generate CONCAT(cmp,mod);
grunt> dump B;
(SamsungOptima)
(OnidaLucid)
(AkaiDecent)
(LavaAttention)
(ZenSuper)
(SamsungOptima)
(OnidaLucid)
(OnidaDecent)
(OnidaNA)
(LavaAttention)
(ZenSuper)
(SamsungOptima)
(NALucid)
(SamsungDecent)
(LavaAttention)
(SamsungSuper)
(SamsungSuper)
(SamsungSuper)
===============================
grunt> X = foreach A generate TOKENIZE(state);
grunt> dump X;
cess : 1
({(Madhya),(Pradesh)})
({(Uttar),(Pradesh)})
({(Kerala)})
({(Assam)})
({(Maharashtra)})
({(Madhya),(Pradesh)})
({(Uttar),(Pradesh)})
({(Uttar),(Pradesh)})
({(Kerala)})
({(Assam)})
({(Maharashtra)})
({(Madhya),(Pradesh)})
({(Uttar),(Pradesh)})
({(Kerala)})
({(Assam)})
({(Maharashtra)})
({(Maharashtra)})
({(Maharashtra)})
=============================================
grunt> B = group A by cmp;
grunt> dump B;
cess : 1
(NA,{(NA,Lucid,18,Uttar Pradesh,232401,16200)})
(Zen,{(Zen,Super,14,Maharashtra,619082,9200),(Zen,Super,14,Maharashtra,619082,9200)})
(Akai,{(Akai,Decent,16,Kerala,922401,12200)})
(Lava,{(Lava,Attention,20,Assam,454601,24200),(Lava,Attention,20,Assam,454601,24200),(Lava,Attention,20,Assam,454601,24200)})
(Onida,{(Onida,Lucid,18,Uttar Pradesh,232401,16200),(Onida,Lucid,18,Uttar Pradesh,232401,16200),(Onida,NA,16,Kerala,922401,12200),(Onida,Decent,14,Uttar Pradesh,232401,16200)})
(Samsung,{(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Decent,16,Kerala,922401,12200),(Samsung,Optima,14,Madhya Pradesh,132401,14200),(Samsung,Optima,14,Madhya Pradesh,132401,14200),(Samsung,Optima,14,Madhya Pradesh,132401,14200)})

grunt> X = foreach B generate group,SUM(A.price);
grunt> dump X;

cess : 1
(NA,16200)
(Zen,18400)
(Akai,12200)
(Lava,72600)
(Onida,60800)
(Samsung,82400)
grunt> 
==========================
grunt> dump B;
cess : 1
(NA,{(NA,Lucid,18,Uttar Pradesh,232401,16200)})
(Zen,{(Zen,Super,14,Maharashtra,619082,9200),(Zen,Super,14,Maharashtra,619082,9200)})
(Akai,{(Akai,Decent,16,Kerala,922401,12200)})
(Lava,{(Lava,Attention,20,Assam,454601,24200),(Lava,Attention,20,Assam,454601,24200),(Lava,Attention,20,Assam,454601,24200)})
(Onida,{(Onida,Lucid,18,Uttar Pradesh,232401,16200),(Onida,Lucid,18,Uttar Pradesh,232401,16200),(Onida,NA,16,Kerala,922401,12200),(Onida,Decent,14,Uttar Pradesh,232401,16200)})
(Samsung,{(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Decent,16,Kerala,922401,12200),(Samsung,Optima,14,Madhya Pradesh,132401,14200),(Samsung,Optima,14,Madhya Pradesh,132401,14200),(Samsung,Optima,14,Madhya Pradesh,132401,14200)})


grunt> X = foreach B generate group,MIN(A.price);
grunt> dump X;
cess : 1
(NA,16200)
(Zen,9200)
(Akai,12200)
(Lava,24200)
(Onida,12200)
(Samsung,9200)
grunt> 
====================================
grunt> dump B;
cess : 1
(NA,{(NA,Lucid,18,Uttar Pradesh,232401,16200)})
(Zen,{(Zen,Super,14,Maharashtra,619082,9200),(Zen,Super,14,Maharashtra,619082,9200)})
(Akai,{(Akai,Decent,16,Kerala,922401,12200)})
(Lava,{(Lava,Attention,20,Assam,454601,24200),(Lava,Attention,20,Assam,454601,24200),(Lava,Attention,20,Assam,454601,24200)})
(Onida,{(Onida,Lucid,18,Uttar Pradesh,232401,16200),(Onida,Lucid,18,Uttar Pradesh,232401,16200),(Onida,NA,16,Kerala,922401,12200),(Onida,Decent,14,Uttar Pradesh,232401,16200)})
(Samsung,{(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Decent,16,Kerala,922401,12200),(Samsung,Optima,14,Madhya Pradesh,132401,14200),(Samsung,Optima,14,Madhya Pradesh,132401,14200),(Samsung,Optima,14,Madhya Pradesh,132401,14200)})


grunt> X = foreach B generate group,MAX(A.price);
grunt> dump X;
(NA,16200)
(Zen,9200)
(Akai,12200)
(Lava,24200)
(Onida,16200)
(Samsung,14200)
===================================================================
grunt> B = limit A 5;
grunt> dump B;
(Samsung,Optima,14,Madhya Pradesh,132401,14200)
(Onida,Lucid,18,Uttar Pradesh,232401,16200)
(Akai,Decent,16,Kerala,922401,12200)
(Lava,Attention,20,Assam,454601,24200)
(Zen,Super,14,Maharashtra,619082,9200)
======================

grunt> store A into '/home/acadgild/new_tele' using PigStorage(',');

[acadgild@localhost ~]$ hadoop fs -cat /home/acadgild/new_tele/part-m-00000
17/10/29 14:19:43 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Samsung,Optima,14,Madhya Pradesh,132401,14200
Onida,Lucid,18,Uttar Pradesh,232401,16200
Akai,Decent,16,Kerala,922401,12200
Lava,Attention,20,Assam,454601,24200
Zen,Super,14,Maharashtra,619082,9200
Samsung,Optima,14,Madhya Pradesh,132401,14200
Onida,Lucid,18,Uttar Pradesh,232401,16200
Onida,Decent,14,Uttar Pradesh,232401,16200
Onida,NA,16,Kerala,922401,12200
Lava,Attention,20,Assam,454601,24200
Zen,Super,14,Maharashtra,619082,9200
Samsung,Optima,14,Madhya Pradesh,132401,14200
NA,Lucid,18,Uttar Pradesh,232401,16200
Samsung,Decent,16,Kerala,922401,12200
Lava,Attention,20,Assam,454601,24200
Samsung,Super,14,Maharashtra,619082,9200
Samsung,Super,14,Maharashtra,619082,9200
Samsung,Super,14,Maharashtra,619082,9200
[acadgild@localhost ~]$ 



=======================
grunt> A = load '/vishnu/television.txt' using PigStorage ('|') as (cmp:chararray,mod:chararray,size:int,state:chararray,pin:long,price:long);

(Samsung,Optima,14,Madhya Pradesh,132401,14200)
(Onida,Lucid,18,Uttar Pradesh,232401,16200)
(Akai,Decent,16,Kerala,922401,12200)
(Lava,Attention,20,Assam,454601,24200)
(Zen,Super,14,Maharashtra,619082,9200)
(Samsung,Optima,14,Madhya Pradesh,132401,14200)
(Onida,Lucid,18,Uttar Pradesh,232401,16200)
(Onida,Decent,14,Uttar Pradesh,232401,16200)
(Onida,NA,16,Kerala,922401,12200)
(Lava,Attention,20,Assam,454601,24200)
(Zen,Super,14,Maharashtra,619082,9200)
(Samsung,Optima,14,Madhya Pradesh,132401,14200)
(NA,Lucid,18,Uttar Pradesh,232401,16200)
(Samsung,Decent,16,Kerala,922401,12200)
(Lava,Attention,20,Assam,454601,24200)
(Samsung,Super,14,Maharashtra,619082,9200)
(Samsung,Super,14,Maharashtra,619082,9200)
(Samsung,Super,14,Maharashtra,619082,9200)



grunt> B = distinct A;
grunt> dump B;
ess : 1
(NA,Lucid,18,Uttar Pradesh,232401,16200)
(Zen,Super,14,Maharashtra,619082,9200)
(Akai,Decent,16,Kerala,922401,12200)
(Lava,Attention,20,Assam,454601,24200)
(Onida,NA,16,Kerala,922401,12200)
(Onida,Lucid,18,Uttar Pradesh,232401,16200)
(Onida,Decent,14,Uttar Pradesh,232401,16200)
(Samsung,Super,14,Maharashtra,619082,9200)
(Samsung,Decent,16,Kerala,922401,12200)
(Samsung,Optima,14,Madhya Pradesh,132401,14200)
grunt> 
===========================================

grunt> A = load '/vishnu/television.txt' using PigStorage ('|') as (cmp:chararray,mod:chararray,size:int,state:chararray,pin:long,price:long);

(Samsung,Optima,14,Madhya Pradesh,132401,14200)
(Onida,Lucid,18,Uttar Pradesh,232401,16200)
(Akai,Decent,16,Kerala,922401,12200)
(Lava,Attention,20,Assam,454601,24200)
(Zen,Super,14,Maharashtra,619082,9200)
(Samsung,Optima,14,Madhya Pradesh,132401,14200)
(Onida,Lucid,18,Uttar Pradesh,232401,16200)
(Onida,Decent,14,Uttar Pradesh,232401,16200)
(Onida,NA,16,Kerala,922401,12200)
(Lava,Attention,20,Assam,454601,24200)
(Zen,Super,14,Maharashtra,619082,9200)
(Samsung,Optima,14,Madhya Pradesh,132401,14200)
(NA,Lucid,18,Uttar Pradesh,232401,16200)
(Samsung,Decent,16,Kerala,922401,12200)
(Lava,Attention,20,Assam,454601,24200)
(Samsung,Super,14,Maharashtra,619082,9200)
(Samsung,Super,14,Maharashtra,619082,9200)
(Samsung,Super,14,Maharashtra,619082,9200)

grunt> B = group A by cmp;
grunt> dump B;
(NA,{(NA,Lucid,18,Uttar Pradesh,232401,16200)})
(Zen,{(Zen,Super,14,Maharashtra,619082,9200),(Zen,Super,14,Maharashtra,619082,9200)})
(Akai,{(Akai,Decent,16,Kerala,922401,12200)})
(Lava,{(Lava,Attention,20,Assam,454601,24200),(Lava,Attention,20,Assam,454601,24200),(Lava,Attention,20,Assam,454601,24200)})
(Onida,{(Onida,Lucid,18,Uttar Pradesh,232401,16200),(Onida,Lucid,18,Uttar Pradesh,232401,16200),(Onida,NA,16,Kerala,922401,12200),(Onida,Decent,14,Uttar Pradesh,232401,16200)})
(Samsung,{(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Super,14,Maharashtra,619082,9200),(Samsung,Decent,16,Kerala,922401,12200),(Samsung,Optima,14,Madhya Pradesh,132401,14200),(Samsung,Optima,14,Madhya Pradesh,132401,14200),(Samsung,Optima,14,Madhya Pradesh,132401,14200)})

grunt> C = foreach B generate group,A.cmp;
grunt> dump C;
cess : 1
(NA,{(NA)})
(Zen,{(Zen),(Zen)})
(Akai,{(Akai)})
(Lava,{(Lava),(Lava),(Lava)})
(Onida,{(Onida),(Onida),(Onida),(Onida)})
(Samsung,{(Samsung),(Samsung),(Samsung),(Samsung),(Samsung),(Samsung),(Samsung)})
grunt> 

grunt> D = foreach C generate group,FLATTEN($1);
grunt> dump D;

(NA,NA)
(Zen,Zen)
(Zen,Zen)
(Akai,Akai)
(Lava,Lava)
(Lava,Lava)
(Lava,Lava)
(Onida,Onida)
(Onida,Onida)
(Onida,Onida)
(Onida,Onida)
(Samsung,Samsung)
(Samsung,Samsung)
(Samsung,Samsung)
(Samsung,Samsung)
(Samsung,Samsung)
(Samsung,Samsung)
(Samsung,Samsung)
=====================
grunt> A = load '/home/acadgild/vishnu/data1.txt' using PigStorage(' ') as(id:int,age:int);

grunt> dump A;
(1,35)
(2,36)

 B = load '/vishnu/dat21.txt' using PigStorage(' ') as(age:int,sex:chararray);

grunt> dump B;
(35,Male)
(39,Female)

grunt> C = cogroup A by age,B by age;
grunt> dump c;
(35,{(1,35)},{(35,Male)})
(36,{(2,36)},{})
(39,{},{(39,Female)})
grunt> 

grunt> D = filter C by IsEmpty(A);
grunt> dump D;
(39,{},{(39,Female)})


